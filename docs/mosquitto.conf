# =================================================================
# Arquivo de Configuração do Mosquitto para IoT
# =================================================================

# --- Persistência ---
# Habilita a persistência de dados (mensagens com QoS > 0, sessões, etc.).
# Essencial para que o broker se lembre dos estados entre reinicializações.
persistence true
persistence_location /mosquitto/data/

# --- Logging ---
# Define para onde os logs do broker devem ser enviados.
log_dest file /mosquitto/log/mosquitto.log
log_type all

# --- Listeners ---
# Configura as portas e protocolos que o broker irá escutar.

# Listener padrão para MQTT na porta 1883, para os dispositivos ESP32.
listener 1883
protocol mqtt

# Listener para MQTT sobre WebSockets, útil para painéis de controle web.
# Descomente as duas linhas abaixo se precisar de comunicação via navegador.
# listener 9001
# protocol websockets

# --- Segurança ---
# ATENÇÃO: A configuração abaixo permite conexões anônimas de qualquer cliente.
# É útil para desenvolvimento e testes iniciais, mas MUITO INSEGURO para produção.
allow_anonymous true

# =================================================================
# RECOMENDAÇÕES PARA PRODUÇÃO
# =================================================================
# Em um ambiente de produção, você DEVE desabilitar o acesso anônimo
# e configurar autenticação para seus dispositivos.

# 1. Desabilite o acesso anônimo:
# allow_anonymous false
#
# 2. Especifique um arquivo de senhas:
# password_file /mosquitto/config/password.txt
#
# 3. Crie o arquivo de senhas. No seu `docker-compose.yml`, você pode fazer
#    isso com um serviço temporário ou montando um arquivo já existente.
#    O comando para criar um usuário é:
#    mosquitto_passwd -c /caminho/para/password.txt nome_do_usuario
#
# 4. Configure o ESP32 para conectar com usuário e senha.
# =================================================================
